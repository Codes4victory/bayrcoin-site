<!DOCTYPE html> 
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BayrCoin Wallet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 40px;
        }
    </style>
</head>
<body>
    <h2>BayrCoin Wallet</h2>
    <p>Hier kannst du dein Guthaben einsehen und Coins senden:</p>

    <!-- ANMELDEFORMULAR -->
    <h3>Registrierung / Login</h3>
    <input type="email" id="registerEmail" placeholder="E-Mail eingeben">
    <input type="password" id="registerPassword" placeholder="Passwort">
    <button onclick="registerUser()">Anmelden</button>
    <div id="registerStatus"></div>

    <!-- GUTHABEN PRÜFEN -->
    <h3>Guthaben prüfen</h3>
    <input type="email" id="email" placeholder="E-Mail eingeben">
    <button onclick="getBalance()">Guthaben prüfen</button>
    <div id="guthaben">Warte auf Eingabe...</div>

    <!-- BAYRCOIN SENDEN -->
    <h3>BayrCoin senden</h3>
    <input type="email" id="sender" placeholder="Deine E-Mail">
    <input type="email" id="receiver" placeholder="Empfänger E-Mail">
    <input type="number" id="amount" placeholder="Menge">
    <button onclick="sendCoins()">Senden</button>
    <div id="transaktionsStatus"></div>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbwk0Y4IZTpm9kysvP6IU3KLBdUVeKxoA4H8zlBi8sKWXAbMign4MzZDW-bnWNJbcCW4kg/exec";

        function registerUser() {
            let email = document.getElementById("registerEmail").value;
            let password = document.getElementById("registerPassword").value;

            if (!email || !password) {
                alert("Bitte alle Felder ausfüllen!");
                return;
            }

            fetch(API_URL + "?action=register&email=" + encodeURIComponent(email) + "&password=" + encodeURIComponent(password))
                .then(response => response.text())
                .then(data => {
                    document.getElementById("registerStatus").innerText = data;
                })
                .catch(error => {
                    document.getElementById("registerStatus").innerText = "Fehler bei der Anmeldung.";
                    console.error(error);
                });
        }

        function getBalance() {
            let email = document.getElementById("email").value;
            if (!email) {
                alert("Bitte E-Mail eingeben!");
                return;
            }

            fetch(API_URL + "?action=getBalance&email=" + encodeURIComponent(email))
                .then(response => response.text())
                .then(data => {
                    document.getElementById("guthaben").innerText = "Dein Guthaben: " + data + " BayrCoin";
                })
                .catch(error => {
                    document.getElementById("guthaben").innerText = "Fehler beim Laden der Daten.";
                    console.error(error);
                });
        }

        function sendCoins() {
            let sender = document.getElementById("sender").value;
            let receiver = document.getElementById("receiver").value;
            let amount = document.getElementById("amount").value;

            if (!sender || !receiver || !amount) {
                alert("Bitte alle Felder ausfüllen!");
                return;
            }

            fetch(API_URL + "?action=transfer&email=" + encodeURIComponent(sender) + "&receiver=" + encodeURIComponent(receiver) + "&amount=" + encodeURIComponent(amount))
                .then(response => response.text())
                .then(data => {
                    document.getElementById("transaktionsStatus").innerText = data;
                })
                .catch(error => {
                    document.getElementById("transaktionsStatus").innerText = "Fehler bei der Transaktion.";
                    console.error(error);
                });
        }
    </script>
</body>
</html>
